#!/usr/bin/env ruby

require 'thor'
require 'mushy'

class RailsCLI < Thor

  desc "start FILE", "Run this workflow file."
  def start file
    content = File.open(file).read
    puts content
  end

  desc "build FILE", 'Build a flow.'
  def build file

    RailsCLI.serve_the_builder

  end

  def self.serve_the_builder
    @serve_the_builder = true
  end

  def self.serve_the_builder?
    @serve_the_builder || false
  end

end

RailsCLI.start(ARGV)

exit unless RailsCLI.serve_the_builder?

require 'sinatra'
enable :run

get '/' do
   File.read(File.join(File.dirname(__FILE__), 'public', 'index.html'))
end